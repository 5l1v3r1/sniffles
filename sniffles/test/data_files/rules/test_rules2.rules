#test rule file 2
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test2-1"; flow:to_server,established; content:"Cookie|3A| =|0D 0A 0D 0A|"; fast_pattern:only; classtype:denial-of-service; sid:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test2-2"; flow:to_server,established; content:"P=*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?"; fast_pattern:only; classtype:attempted-dos; sid:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test2-3"; flow:to_server,established; content:".action?"; nocase; http_uri; content:"debug=command"; distance:0; nocase; http_uri; content:"Runtime|28 29|.exec"; distance:0; nocase; http_uri; classtype:attempted-user; sid:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"test2-4"; flow:to_server,established; content:"/%2E%2E"; fast_pattern:only; content:"/%2E%2E"; nocase; http_raw_uri; pcre:"/\/%2E%2E(\\|%5C)\//"; classtype:web-application-attack; sid:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test2-5"; flow:to_server,established; content:"Proxy-Connection|3A| Keep-Alive|0D 0A|Okytuasd|3A| AAAA"; http_header; classtype:attempted-admin; sid:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test2-6"; flow:to_server,established; content:"1|C0|1|C9|d|8B|q0|8B|v|0C 8B|v|1C 8B|V|08 8B|~ |8B|6f9O|14|u|F2|f|B9 01|mf|81 E9 94|lf9|0F|f|89 C1|u|E1 89 E5 EB|q`|8B|l|24 24 8B|E<|8B|T|05|x|01 EA 8B|J|18 8B|Z |01 EB E3|4I|8B|4|8B 01 EE|1|FF|1|C0 FC AC 84 C0|t|07 C1 CF 0D 01 C7 EB F4 3B 7C 24 28|u|E1 8B|Z|24 01 EB|f|8B 0C|K|8B|Z|1C 01 EB 8B 04 8B 01 E8 89|D|24 1C|a|C3 AD|PR|E8 AA FF FF FF 89 07|f|81 C4 0C 01|f|81 EC 04 01|f|81 C7 08 01|f|81 EF 04 01|9|CE|u|DE C3 EB 10|^|8D|}|04 89 F1 80 C1 0C E8 CD FF FF FF EB 3B E8 EB FF FF FF|n|7C|.|E1 1E|<?|D7|t|1E|H|CD|1|D2|X|88|P|07 EB|/1|D2|Y|88|Q|01 EB|.QP|FF|U|04 EB|,1|D2|Y|88|Q|09 EB|3QP|89 C6 FF|U|08|S|FF|U|0C E8 D1 FF FF FF|sos.txtN|E8 CC FF FF FF|wN|E8 CD FF FF FF E8 CF FF FF FF|pwn-isapiN|E8 C8 FF FF FF 90 90 90 90|"; classtype:attempted-admin; sid:6;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test2-7"; flow:to_server,established; content:".action?"; nocase; http_uri; content:"new java.io.FileWriter"; distance:0; nocase; http_uri; pcre:"/[\x26\x3f](\w+)=([A-Z]\x3a\x2f|\x2e{2}?\x2f)[^\x26]*?\x2e[a-z0-9\x2e]{1,6}\x26[^\x26]*?FileWriter\x28\s*\1\s*\x29/i"; classtype:attempted-user; sid:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test2-8"; flow:to_server,established; content:".action?"; nocase; http_uri; content:"=|27|"; distance:0; http_uri; content:"new "; distance:0; nocase; http_uri; pcre:"/new (javax?|org)/i"; classtype:attempted-user; sid:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"test2-9"; flow:to_server,established; content:"/..%5C/"; fast_pattern:only; content:"/..%5C/"; http_raw_uri; classtype:web-application-attack; sid:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"test2-10"; flow:to_server,established; content:"/|5C|../"; fast_pattern:only; content:"/|5C|../"; nocase; http_raw_uri; classtype:web-application-attack; sid:10;)
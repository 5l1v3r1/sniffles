#test rule file 1
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test1-1"; flow:to_server,established; content:"work.Method.denyExecution"; nocase; http_uri; content:"u0023"; nocase; http_uri; sid:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test1-2"; flow:to_server,established; content:".action?"; nocase; http_uri; content:"=|27|"; distance:0; http_uri; content:"allowMethodAccess"; distance:0; nocase; http_uri; content:"Runtime|28 29|.exec"; distance:0; nocase; http_uri; classtype:attempted-user; sid:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"test1-3"; flow:to_server,established; content:"/%5C../"; fast_pattern:only; content:"/%5C../"; nocase; http_raw_uri; classtype:web-application-attack; sid:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"test1-4"; flow:to_server,established; content:"/..|5C|/"; fast_pattern:only; content:"/..|5C|/"; http_raw_uri; classtype:web-application-attack; sid:4;)
#alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test1-5"; flow:to_server,established; content:".action"; fast_pattern:only; http_uri; content:"|28|"; depth:1; http_cookie; pcre:"/^\x28[^\x3D]+?\x29\x3D/m"; classtype:attempted-user; sid:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8081 (msg:"test1-6"; flow:to_server,established; content:"/manager"; nocase; content:"Authorization"; distance:0; nocase; content:"Basic"; within:50; nocase; content:"b3Z3ZWJ1c3I6T3ZXKmJ1c3Ix"; within:100; nocase; classtype:attempted-admin; sid:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test1-7"; flow:to_server,established; content:"/struts"; nocase; http_uri; content:"|25|252f"; nocase; http_raw_uri; classtype:attempted-recon; sid:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test1-8"; flow:to_server,established; content:"Proxy-Connection: Keep-Alive"; http_header; content:"Transfer-Encoding: chunked|0D 0A|Content-Length: 40334"; fast_pattern:only; http_header; content:".dll"; http_uri; classtype:attempted-admin; sid:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"test1-9"; flow:to_server,established; content:"%2E%2E/"; fast_pattern:only; content:"%2E%2E/"; nocase; http_raw_uri; pcre:"/\/(\\|%5C)%2E%2E\//"; sid:9;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"test1-10"; flow:to_server,established; content:"POST"; http_method; content:"=|27|"; http_client_body; content:"new"; nocase; http_client_body; pcre:"/new(%20)?(javax?|org|com)/i"; classtype:attempted-admin; sid:10;)